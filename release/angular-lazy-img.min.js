angular.module("angularLazyImg",[]),angular.module("angularLazyImg").factory("LazyImgMagic",["$window","lazyImgConfig","lazyImgHelpers",function(a,b,c){"use strict";function l(){for(var a=0;g>a;a++){var b=f[a];c.isElementInView(b.$elem[0],i.offset,d)&&(p(b),o(a),a--)}}function m(a){(i.container||e)[a]("scroll",j),(i.container||e)[a]("touchmove",j),e[a]("resize",j),e[a]("resize",k)}function n(){h=!0,setTimeout(function(){l(),m("on")},1)}function o(a){f.splice(a,1),g--}function p(a){var b=new Image;b.onerror=function(){i.errorClass&&a.$elem.addClass(i.errorClass),i.onError(a)},b.onload=function(){q(a.$elem,a.src),i.successClass&&a.$elem.addClass(i.successClass),i.onSuccess(a)},b.src=a.src}function q(a,b){"img"===a[0].nodeName.toLowerCase()?a[0].src=b:a.css("background-image",'url("'+b+'")')}function r(a){this.$elem=a}var d,e,f,g,h,i,j,k;return f=[],g=0,h=!1,i=b.getOptions(),e=angular.element(a),d=c.getWinDimensions(),k=c.throttle(function(){d=c.getWinDimensions()},60),j=c.throttle(l,30),r.prototype.setSource=function(a){this.src=a,f.push(this),g++,h||n()},r.prototype.removeImage=function(){var a=f.indexOf(this);o(a)},r}]),angular.module("angularLazyImg").provider("lazyImgConfig",function(){"use strict";this.options={offset:100,errorClass:null,successClass:null,onError:function(){},onSuccess:function(){}},this.$get=function(){var a=this.options;return{getOptions:function(){return a}}},this.setOptions=function(a){angular.extend(this.options,a)}}),angular.module("angularLazyImg").factory("lazyImgHelpers",["$window",function(a){"use strict";function b(){return{height:a.innerHeight,width:a.innerWidth}}function c(a,b,c){var d=a.getBoundingClientRect(),e=c.height+b;return d.left>=0&&d.right<=c.width+b&&(d.top>=0&&d.top<=e||d.bottom<=e&&d.bottom>=0-b)}function d(a,b,c){var d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&d+b>g?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}}return{isElementInView:c,getWinDimensions:b,throttle:d}}]),angular.module("angularLazyImg").directive("lazyImg",["LazyImgMagic",function(a){"use strict";function b(b,c,d){var e=new a(c);d.$observe("lazyImg",function(a){a&&e.setSource(a)}),b.$on("$destroy",function(){e.removeImage()})}return{link:b,restrict:"A"}}]);